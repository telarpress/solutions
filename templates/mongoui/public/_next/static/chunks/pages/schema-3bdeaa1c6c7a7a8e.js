(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[707],{90695:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/schema",function(){return n(39396)}])},8817:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(85893),i=n(70161);function o(){let e=(0,i.gh)();return(0,r.jsx)("div",{style:{width:"100%",height:0,borderTopWidth:1,borderTopStyle:"solid",borderTopColor:e.palette.neutralLight}})}},77752:function(e,t,n){"use strict";var r=n(85893),i=n(67294),o=n(70161),a=n(52672),s=n(11898),c=n(18446),l=n.n(c);t.Z=(0,i.memo)(function(e){let t=(0,o.gh)();return(0,r.jsx)("div",{style:{width:"100%",height:"100%",flex:1,display:"flex",alignItems:"center",justifyContent:"center",...e.style},children:(0,r.jsxs)("div",{style:{maxWidth:600,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)(a.J,{iconName:e.iconName,styles:{root:{color:t.palette.neutralPrimaryAlt,fontSize:64,height:64,margin:20,wordBreak:"break-all"}}}),(0,r.jsx)(s.x,{variant:"xLarge",styles:{root:{color:t.palette.neutralSecondary,fontSize:48}},children:e.title})]}),e.content?(0,r.jsx)(s.x,{variant:"large",styles:{root:{color:t.palette.neutralSecondary,marginLeft:20,wordBreak:"break-all"}},children:e.content}):null,e.button]})})},l())},39396:function(e,t,n){"use strict";n.a(e,async function(e,r){try{n.r(t),n.d(t,{default:function(){return D}});var i=n(85893),o=n(67294),a=n(19277),s=n(55037),c=n(57318),l=n(20215),u=n(63764),m=n(26162),d=n(70141),f=n(67849),p=n(77752),y=n(83482),b=n(32358),g=n(70813),h=n(64262),$=n(79989),x=n(8817),v=n(14151),S=n(56529),T=n(6558),j=e([m,g,T]);function D(){let[{conn:e,database:t,collection:n}]=(0,S.Z)(),{data:r,mutate:j}=(0,g.mm)(),D=(0,d.Z)(),[w,I]=(0,o.useState)(null),[O,k]=(0,o.useState)(null),[_,E]=(0,o.useState)(""),K=(0,T.R)(e),N=(0,o.useCallback)(async()=>t&&n?(0,m.f)(K,t,{collMod:n,validationAction:w,validationLevel:O,validator:{$jsonSchema:(0,f.Qc)(_.replace(/^return/,""))}}):void 0,[K,t,n,_,w,O]),z=(0,$.Z)(N);(0,o.useEffect)(()=>{z.resolved&&j()},[z.resolved,j]),(0,o.useEffect)(()=>{var e;if(!(null==r?void 0:r.cursor.firstBatch[0]))return;let{options:t}=r.cursor.firstBatch[0],n=(0,f.Pz)(null===(e=t.validator)||void 0===e?void 0:e.$jsonSchema,!0);I(t.validationAction||null),k(t.validationLevel||null),E(n?"return ".concat(n):"return {}")},[r]);let L=(0,o.useCallback)(e=>{E(e||"")},[]),A=(0,o.useMemo)(()=>({tabSize:v.t.tabSize.get,wordWrap:"on",contextmenu:!1,scrollbar:{verticalScrollbarSize:0,horizontalSliderSize:0}}),[]),R=(0,o.useCallback)(async()=>{if(!t||!n)return;let{cursor:{firstBatch:e}}=await (0,m.f)(K,t,{find:n},{canonical:!0});return(0,f.Pz)((0,y.q)(e),!0)},[n,K,t]),C=(0,$.Z)(R);return((0,o.useEffect)(()=>{let e=C.resolved;void 0===e||(E(e?"return ".concat(e):"return {}"),w||I(b.w_.WARN),O||k(b.Ht.OFF))},[C.resolved,w,O]),t&&n)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.ZP,{language:"typescript",theme:D?"vs-dark":"vs",value:_,onChange:L,options:A}),(0,i.jsx)(x.Z,{}),(0,i.jsxs)(a.K,{horizontal:!0,tokens:{padding:10},styles:{root:{height:52,display:"flex",alignItems:"center",justifyContent:"space-between"}},children:[(0,i.jsx)(s._,{styles:{root:{marginRight:10}},children:"Validation action:"}),(0,i.jsx)(c.L,{selectedKey:w,onChange:(e,t)=>{I(null==t?void 0:t.key)},errorMessage:_&&!w?" ":void 0,styles:{root:{marginRight:10,width:140,height:32}},options:[{key:b.w_.WARN,text:b.w_.WARN},{key:b.w_.ERROR,text:b.w_.ERROR}],placeholder:"please select"}),(0,i.jsx)(s._,{styles:{root:{marginLeft:20,marginRight:10}},children:"Validation level:"}),(0,i.jsx)(c.L,{selectedKey:O,onChange:(e,t)=>{k(null==t?void 0:t.key)},errorMessage:_&&!O?" ":void 0,styles:{root:{width:140,height:32}},options:[{key:b.Ht.OFF,text:b.Ht.OFF},{key:b.Ht.MODERATE,text:b.Ht.MODERATE},{key:b.Ht.STRICT,text:b.Ht.STRICT}],placeholder:"please select"}),(0,i.jsx)(a.K.Item,{grow:!0,children:(0,i.jsx)("div",{})}),(0,i.jsx)(l.G,{content:"Auto generate schema",children:(0,i.jsx)(h.Z,{icon:"AutoEnhanceOn",promise:C})}),(0,i.jsx)(h.Z,{icon:"CheckMark",disabled:!w||!O||!_,promise:z})]})]}):(0,i.jsx)(p.Z,{iconName:"Back",title:"Select Collection"})}[m,g,T]=j.then?(await j)():j,r()}catch(e){r(e)}})},67849:function(e,t,n){"use strict";n.d(t,{Pz:function(){return function e(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("string"==typeof t)return JSON.stringify(t);if("number"==typeof t)return t.toString();if("boolean"==typeof t)return"".concat(t);if(void 0===t)return"";if(null===t)return"null";if("$oid"in t)return'ObjectId("'.concat(t.$oid,'")');if("$date"in t&&"$numberLong"in t.$date)return a.t.timezoneOffset?'Date("'.concat((0,o.p)(parseInt(t.$date.$numberLong,10)),'")'):'ISODate("'.concat(new Date(parseInt(t.$date.$numberLong,10)).toISOString(),'")');if("$numberDecimal"in t)return'NumberDecimal("'.concat(t.$numberDecimal,'")');if("$numberDouble"in t)return t.$numberDouble;if("$numberInt"in t)return t.$numberInt;if("$numberLong"in t)return'NumberLong("'.concat(t.$numberLong,'")');if("$regularExpression"in t)return"/".concat(t.$regularExpression.pattern,"/").concat(t.$regularExpression.options||"");if("$timestamp"in t)return"Timestamp(".concat(t.$timestamp.t,", ").concat(t.$timestamp.i,")");if("$binary"in t)return"BinData(".concat(parseInt(t.$binary.subType,16),', "').concat(t.$binary.base64,'")');if("$minKey"in t&&1===t.$minKey)return"MinKey()";if("$maxKey"in t&&1===t.$maxKey)return"MaxKey()";if(Array.isArray(t)){if(!n)return"[".concat(t.map(t=>"".concat(e(t,n,r+a.t.tabSize.get))).join(", "),"]");let i=Array.from({length:r}).map(()=>" ").join("");return t.length?"[\n".concat(t.map(t=>"".concat(c).concat(i).concat(e(t,n,r+a.t.tabSize.get))).join(",\n"),"\n").concat(i,"]"):"[]"}let i=Object.entries(t);if(0===i.length)return"{}";if(!n)return"{ ".concat(i.map(t=>{let[i,o]=t;return"".concat(s(i),": ").concat(e(o,n,r+a.t.tabSize.get))}).join(", ")," }");let l=Array.from({length:r}).map(()=>" ").join("");return"{\n".concat(i.map(t=>{let[i,o]=t;return"".concat(c).concat(l).concat(s(i),": ").concat(e(o,n,r+a.t.tabSize.get))}).join(",\n"),"\n").concat(l,"}")}},Qc:function(){return u},vH:function(){return l}});var r=n(85058),i=n.n(r),o=n(49813),a=n(14151);function s(e){let t=e.toString();return t.includes("-")||t.includes(" ")||t.includes(".")||/^\d/.test(t)?'"'.concat(e,'"'):e}let c=Array.from({length:a.t.tabSize.get}).map(()=>" ").join(""),l={SubType:{Generic:0,Function:1,Binary_old:2,UUID_old:3,UUID:4,MD5:5,Encrypted:6,UserDefined:128},ObjectId:e=>({$oid:e}),Date:e=>({$date:{$numberLong:void 0!==e?new Date(e).getTime().toString():new Date().getTime().toString()}}),ISODate:e=>({$date:{$numberLong:void 0!==e?new Date(e).getTime().toString():new Date().getTime().toString()}}),NumberDecimal:e=>({$numberDecimal:e.toString()}),NumberInt:e=>({$numberInt:e.toString()}),NumberLong:e=>({$numberLong:e.toString()}),Timestamp:(e,t)=>({$timestamp:{t:e,i:t}}),BinData:(e,t)=>({$binary:{base64:t,subType:e.toString(16)}}),MinKey:()=>({$minKey:1}),MaxKey:()=>({$maxKey:1})};function u(e){return JSON.parse(JSON.stringify(i()(e,l),(e,t)=>t instanceof RegExp?{$regularExpression:{pattern:t.source,options:t.flags}}:t))}},49813:function(e,t,n){"use strict";n.d(t,{p:function(){return u},u:function(){return l}});var r=n(27484),i=n.n(r),o=n(70178),a=n.n(o),s=n(14151);i().extend(a());let c=Intl.NumberFormat();function l(e){return c.format(e)}function u(e){return 0===s.t.timezoneOffset.get?new Date(e).toISOString():i()(e).utcOffset(s.t.timezoneOffset.get).format()}},83482:function(e,t,n){"use strict";n.d(t,{q:function(){return b}});var r=n(66604),i=n.n(r),o=n(57557),a=n.n(o),s=n(44908),c=n.n(s),l=n(14176),u=n.n(l),m=n(14293),d=n.n(m),f=n(9996),p=n.n(f);function y(e){return"string"==typeof e?{bsonType:["string"]}:"number"==typeof e?{bsonType:["number"]}:"boolean"==typeof e?{bsonType:["bool"]}:null==e?{bsonType:["null"]}:"$oid"in e?{bsonType:["objectId"]}:"$date"in e&&"$numberLong"in e.$date?{bsonType:["date"]}:"$numberDecimal"in e?{bsonType:["decimal"]}:"$numberDouble"in e?{bsonType:["double"]}:"$numberInt"in e?{bsonType:["int"]}:"$numberLong"in e?{bsonType:["long"]}:"$regularExpression"in e?{bsonType:["regex"]}:"$timestamp"in e?{bsonType:["timestamp"]}:"$binary"in e?{bsonType:["binData"]}:"$minKey"in e&&1===e.$minKey?{bsonType:["minKey"]}:"$maxKey"in e&&1===e.$maxKey?{bsonType:["maxKey"]}:Array.isArray(e)?{bsonType:["array"],items:p().all(e.map(y))}:{bsonType:["object"],properties:i()(a()(e,["__v"]),y)}}function b(e){return function e(t){let n=c()(t.bsonType);return u()({bsonType:1===n.length?n[0]:n,items:Array.isArray(t.items)?t.items.map(e):t.items?e(t.items):void 0,properties:t.properties?i()(t.properties,e):void 0},d())}(p().all(e.map(y)))}}},function(e){e.O(0,[300,557,318,933,888,774,179],function(){return e(e.s=90695)}),_N_E=e.O()}]);